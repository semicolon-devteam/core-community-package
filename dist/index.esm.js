import{jsxs as e,jsx as t}from"react/jsx-runtime";import*as r from"react";import n,{forwardRef as s,useState as a,useRef as o,useMemo as i,useEffect as c,useCallback as l}from"react";import d,{AxiosError as u}from"axios";import"lodash";import{updateDeviceTypeFromWidth as m}from"@redux/Features/App/appSlice";import{selectUIState as h,showMiniLoading as p,hideMiniLoading as g,setMiniLoadingText as y,showLoading as f,hideAllLoaders as b,hideLoading as w,setLoadingText as x}from"@redux/Features/UI/uiSlice";import"@redux/Features/Popup/popupSlice";import{useRouter as v,usePathname as S}from"next/navigation";import{showToast as N}from"@redux/Features/Toast/toastSlice";import{selectUserInfo as E,login as k,logout as T,autoLogin as _}from"@redux/Features/User/userSlice";import{getUserLevel as I,isAdmin as P,hasLevelPermission as U,hasBoardPermission as M}from"@util/authUtil";import{getCurrentUserFromToken as C}from"@util/jwtUtil";import A from"@services/pointService";import{useQuery as $}from"@tanstack/react-query";import{timeAgo as O}from"@util/dateUtil";import L from"@services/commentService";import{createClient as R}from"@supabase/supabase-js";const D=e=>{if(null==e||""===e)return"";const t=("number"==typeof e?e.toString():e).split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.length>1?t.join("."):t[0]};var F=Object.freeze({__proto__:null,formatNumberWithComma:D,removeCommaFromString:e=>e?parseFloat(e.replace(/,/g,"")):0});function B(e,t=!1){if(!e)return"";const r=new Date(e);if(isNaN(r.getTime()))return e;const n=r.getFullYear(),s=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0"),o=String(r.getHours()).padStart(2,"0"),i=String(r.getMinutes()).padStart(2,"0"),c=String(r.getSeconds()).padStart(2,"0");return t?`${n}.${s}.${a}`:`${n}.${s}.${a}. ${o}:${i}:${c}`}function j(e,t=!0){if(!e)return"";const r=new Date(e);if(isNaN(r.getTime()))return e;const n=new Date,s=Math.floor((n.getTime()-r.getTime())/1e3);if(s<60)return"ë°©ê¸ˆ ì „";const a=Math.floor(s/60);if(a<60)return`${a}ë¶„ ì „`;const o=Math.floor(a/60);return o<24?`${o}ì‹œê°„ ì „`:t?z.toChar(e,"MM.dd"):z.toChar(e,"yyyy.MM.dd. HH:mm:ss")}const z={toChar(e,t="YYYY.MM.DD. HH:MM:SS"){const r="string"==typeof e?new Date(e):e;if(!r||isNaN(r.getTime()))return"";const n={yyyy:String(r.getFullYear()),MM:String(r.getMonth()+1).padStart(2,"0"),dd:String(r.getDate()).padStart(2,"0"),HH:String(r.getHours()).padStart(2,"0"),mm:String(r.getMinutes()).padStart(2,"0"),ss:String(r.getSeconds()).padStart(2,"0")};return Object.entries(n).reduce((e,[t,r])=>e.replace(t,r),t)}};var W=Object.freeze({__proto__:null,DateUtil:z,formatDate:B,timeAgo:j});function V(e){return e&&"string"==typeof e.sub&&e.user_metadata}function q(e){return e&&"string"==typeof e.id&&e.nickname&&e.permissionType}const H=e=>e.level>=99||"admin"===e.permissionType||"super_admin"===e.permissionType,G=e=>!!e&&H(e),J=(e,t=0)=>{if(!e||"object"==typeof e&&0===Object.keys(e).length)return 0===t;if(G(e))return!0;if(q(e))return e.level>=t;if(V(e)){console.warn("[DEPRECATED] JWT ê¸°ë°˜ ê¶Œí•œ ì²´í¬ëŠ” ê¶Œì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. useAppSelector(selectUserInfo)ë¥¼ ì‚¬ìš©í•˜ì—¬ Redux storeì˜ ì‚¬ìš©ì ì •ë³´ë¥¼ í™œìš©í•˜ì„¸ìš”.");return(e.is_admin?99:e.level||1)>=t}return e.level>=t};var K=Object.freeze({__proto__:null,checkIsAdmin:H,getUserLevel:e=>e?q(e)?e.level||0:V(e)?(console.warn("[DEPRECATED] JWT ê¸°ë°˜ ë ˆë²¨ ì¡°íšŒëŠ” ê¶Œì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. useAppSelector(selectUserInfo)ë¥¼ ì‚¬ìš©í•˜ì—¬ Redux storeì˜ ì‚¬ìš©ì ì •ë³´ë¥¼ í™œìš©í•˜ì„¸ìš”."),e.is_admin?99:e.level||1):e.level||0:0,getUserPermissionType:e=>e?e.permissionType||"user":"anonymous",getUserPermissionTypeFromDB:e=>e?e.permissionType||"user":"anonymous",getUserPermissionTypeFromJWT:e=>e?e.permissionType||"user":"anonymous",hasBoardPermission:(e,t=0,r=!1)=>"free"===t||0===t||!(!r||!e)&&J(e,t),hasLevelPermission:J,isAdmin:G,isAdminOrSuperAdmin:e=>!!e&&H(e),isJWTPayload:V,isSuperAdmin:e=>!!e&&H(e),isUserObject:q,isValidUser:e=>!!e&&"string"==typeof e.id&&!!e.nickname&&!!e.permissionType});const Y={sm:120,md:240,lg:480,xl:720,xxl:960};function Q(e,t="md",r=70){if(!e||!e.includes("/storage/v1/object/"))return e;try{const n=e.replace("/storage/v1/object/","/storage/v1/render/image/"),s="number"==typeof t?t:Y[t],a=Math.max(20,Math.min(100,r)),o=n.includes("?")?"&":"?";return`${n}${o}${`width=${s}&quality=${a}`}`}catch(t){return console.error("Failed to transform Supabase image URL:",t),e}}function X(e,t=["sm","md","lg"],r=70){const n={};return t.forEach(t=>{n[t]=Q(e,t,r)}),n}function Z({src:e,width:t,quality:r}){return`https://community.semi-colon.space/storage/v1/render/image/public/${e}?width=${t}&quality=${r||75}`}function ee(e){if(!e||"string"!=typeof e)return e;try{const t=process.env.NEXT_PUBLIC_STORAGE_URL;if(t&&e.startsWith(t)){const r=e.replace(t,"");return r.startsWith("/")?r:`/${r}`}return e}catch(t){return console.error("Failed to normalize image src:",t),e}}function te(e,t,r){const n=ee(e);return void 0!==t&&n.includes("/storage/v1/object/")?Q(n,t,r):n}function re(e){if(!e||"string"!=typeof e)return!1;const t=e.toLowerCase();return t.endsWith(".gif")||t.includes(".gif?")}var ne=Object.freeze({__proto__:null,IMAGE_SIZE:Y,generateImageSrcSet:X,getImageProps:function(e){return re(e)?{unoptimized:!0}:{}},isAnimatedImage:function(e){return!(!e||"string"!=typeof e)&&(e.toLowerCase(),re(e))},isGifImage:re,normalizeImageSrc:ee,optimizeImageSrc:te,supabaseImageLoader:Z,transformSupabaseImageUrl:Q});class se{static calculateUserLevel(e,t){if(!t.length)return 0;const r=[...t].sort((e,t)=>e.level-t.level);let n=0;for(const t of r){if(!(e>=t.required_points))break;n=t.level}return n}static getLevelProgress(e,t){if(!t.length)return{currentLevel:0,currentLevelPoints:0,nextLevel:1,nextLevelPoints:0,progressPercentage:0,pointsToNext:0};const r=[...t].sort((e,t)=>e.level-t.level),n=this.calculateUserLevel(e,t),s=r.find(e=>e.level===n),a=s?.required_points||0,o=r.find(e=>e.level===n+1),i=o?.level||n,c=o?.required_points||a;let l=0,d=0;if(o){const t=c-a,r=e-a;l=t>0?Math.min(100,r/t*100):100,d=Math.max(0,c-e)}else l=100,d=0;return{currentLevel:n,currentLevelPoints:a,nextLevel:i,nextLevelPoints:c,progressPercentage:Math.round(l),pointsToNext:d}}static getNextLevelInfo(e,t){if(!t.length)return{nextLevel:1,requiredPoint:0,levelUpPercentage:0,isMaxLevel:!0};const r=[...t].sort((e,t)=>e.level-t.level),n=this.calculateUserLevel(e,t),s=r.find(e=>e.level===n),a=s?.required_points||0,o=r.find(e=>e.level===n+1);if(!o)return{nextLevel:n,requiredPoint:0,levelUpPercent:100,isMaxLevel:!0};const i=o.level,c=o.required_points,l=c-a,d=e-a;return{nextLevel:i,requiredPoint:Math.max(0,c-e),levelUpPercent:l>0?Math.min(100,Math.round(d/l*100)):100,isMaxLevel:!1}}}var ae=Object.freeze({__proto__:null,LevelUtil:se});const oe=e=>e.replace(/_([a-z])/g,(e,t)=>t.toUpperCase()),ie=e=>e.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`),ce=e=>{if(null==e)return e;if(Array.isArray(e))return e.map(e=>"object"==typeof e&&null!==e?ce(e):e);if("object"==typeof e){const t={};for(const[r,n]of Object.entries(e)){const e=oe(r);"object"!=typeof n||null===n||Array.isArray(n)?Array.isArray(n)?t[e]=n.map(e=>"object"==typeof e&&null!==e?ce(e):e):t[e]=n:t[e]=ce(n)}return t}return e},le=e=>{if(null==e)return e;if(Array.isArray(e))return e.map(e=>"object"==typeof e&&null!==e?le(e):e);if("object"==typeof e){const t={};for(const[r,n]of Object.entries(e)){const e=ie(r);"object"!=typeof n||null===n||Array.isArray(n)?Array.isArray(n)?t[e]=n.map(e=>"object"==typeof e&&null!==e?le(e):e):t[e]=n:t[e]=le(n)}return t}return e};var de=Object.freeze({__proto__:null,keysToCamelCase:ce,keysToSnakeCase:le,toCamelCase:oe,toSnakeCase:ie});const ue=(e,t)=>{try{const r=e.startsWith("http")?new URL(e):new URL(e,window.location.origin),n=new URLSearchParams(r.search);return Object.entries(t).forEach(([e,t])=>{n.set(e,t)}),`${r.pathname}?${n.toString()}`}catch(e){throw console.error("URL íŒŒì‹± ì˜¤ë¥˜:",e),new Error("ìœ íš¨í•˜ì§€ ì•Šì€ URLì…ë‹ˆë‹¤.")}},me=(e,t,r="/")=>{const n=sessionStorage.getItem(e);if(!n)return r;try{return ue(n,t)}catch(e){return console.error("ì´ì „ URL ì²˜ë¦¬ ì˜¤ë¥˜:",e),r}};var he=Object.freeze({__proto__:null,addUrlParams:ue,getPreviousUrlWithParams:me});function pe(e){try{const t=e.split(".");if(3!==t.length)return console.error("Invalid JWT format"),null;const r=function(e){for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4;)e+="=";return decodeURIComponent(atob(e).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""))}(t[1]);return JSON.parse(r)}catch(e){return console.error("JWT ë””ì½”ë”© ì‹¤íŒ¨:",e),null}}async function ge(){try{const{clientSupabase:e}=await Promise.resolve().then(function(){return jt}),{data:{session:t}}=await e.auth.getSession();return t?.access_token?pe(t.access_token):null}catch(e){return console.error("í† í°ì—ì„œ ì‚¬ìš©ì ì •ë³´ ì¶”ì¶œ ì‹¤íŒ¨:",e),null}}function ye(e){const t=Math.floor(Date.now()/1e3);return e.exp<=t}function fe(e){const t=Math.floor(Date.now()/1e3);return e.exp-t}function be(e="sb-access-token"){if("undefined"!=typeof window)try{const t=document.cookie.split("; ").find(t=>t.startsWith(`${e}=`))?.split("=")[1];if(!t)return;const r=decodeURIComponent(t),n=JSON.parse(r),s=n?.access_token;if(!s)return;const a=pe(s);if(a&&ye(a)){console.log("ğŸ—‘ï¸ ë§Œë£Œëœ í† í° ê°ì§€, ì¿ í‚¤ì—ì„œ ì œê±° ì¤‘..."),document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Lax`;["supabase-auth-token","sb-auth-token","auth-token"].forEach(e=>{document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Lax`}),console.log("âœ… ë§Œë£Œëœ í† í° ì¿ í‚¤ ì œê±° ì™„ë£Œ")}}catch(e){console.error("âŒ ë§Œë£Œëœ í† í° ì œê±° ì¤‘ ì˜¤ë¥˜:",e)}}async function we(){try{const{clientSupabase:e}=await Promise.resolve().then(function(){return jt}),{data:{session:t}}=await e.auth.getSession();if(!t?.access_token)return be(),null;const r=pe(t.access_token);return r?ye(r)?(be(),await e.auth.signOut(),null):r:(be(),null)}catch(e){return console.error("í† í° ê²€ì¦ ë° ì •ë¦¬ ì‹¤íŒ¨:",e),be(),null}}function xe(e){return fe(e)<=300}var ve,Se=Object.freeze({__proto__:null,decodeJWTPayload:pe,getCurrentUserFromToken:ge,getTokenTimeToExpiry:fe,isTokenExpired:ye,removeExpiredTokenFromCookie:be,shouldRefreshToken:xe,validateAndCleanToken:we});!function(e){e.NETWORK_ERROR="network_error",e.FILE_TOO_LARGE="file_too_large",e.UNSUPPORTED_FORMAT="unsupported_format",e.PERMISSION_DENIED="permission_denied",e.SERVER_ERROR="server_error",e.UPLOAD_TIMEOUT="upload_timeout",e.QUOTA_EXCEEDED="quota_exceeded",e.INVALID_POST="invalid_post"}(ve||(ve={}));const Ne={[ve.FILE_TOO_LARGE]:"íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤. ì´ë¯¸ì§€ëŠ” 10MB, ë¹„ë””ì˜¤ëŠ” 100MB ì´í•˜ë¡œ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.",[ve.UNSUPPORTED_FORMAT]:"ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤. JPG, PNG, GIF, WebP, MP4, AVI, MOV íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.",[ve.PERMISSION_DENIED]:"íŒŒì¼ ì—…ë¡œë“œ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",[ve.NETWORK_ERROR]:"ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",[ve.SERVER_ERROR]:"ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",[ve.UPLOAD_TIMEOUT]:"ì—…ë¡œë“œ ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤. íŒŒì¼ í¬ê¸°ë¥¼ í™•ì¸í•˜ê±°ë‚˜ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",[ve.QUOTA_EXCEEDED]:"ì—…ë¡œë“œ í• ë‹¹ëŸ‰ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ íŒŒì¼ì„ ì‚­ì œí•˜ê±°ë‚˜ ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.",[ve.INVALID_POST]:"ìœ íš¨í•˜ì§€ ì•Šì€ ê²Œì‹œê¸€ì…ë‹ˆë‹¤. ê²Œì‹œê¸€ì„ ë‹¤ì‹œ ìƒì„±í•´ì£¼ì„¸ìš”."};var Ee=Object.freeze({__proto__:null,AuthUtils:K,DateUtil:z,DateUtils:W,IMAGE_SIZE:Y,ImageUtils:ne,JwtUtils:Se,LevelUtil:se,LevelUtils:ae,NumberUtils:F,StringUtils:de,get UploadErrorType(){return ve},UrlUtils:he,addUrlParams:ue,calculateUploadMetrics:function(e,t){return{startTime:t,totalFiles:e.length,completedFiles:e.filter(e=>"completed"===e.status).length,failedFiles:e.filter(e=>"failed"===e.status).length,totalBytes:e.reduce((e,t)=>e+(t.fileSize||0),0),uploadedBytes:e.reduce((e,t)=>e+(t.fileSize||0)*((t.progress||0)/100),0),retryCount:0}},calculateUploadSpeed:function(e){const t=(Date.now()-e.startTime)/1e3,r=e.uploadedBytes/1048576;return t>0?r/t:0},decodeJWTPayload:pe,estimateCompletionTime:function(e){const t=Date.now()-e.startTime,r=e.uploadedBytes/e.totalBytes;if(0===r)return null;const n=t/r-t;return Math.max(0,n)},formatDate:B,formatNumberWithComma:D,generateImageSrcSet:X,getCurrentUserFromToken:ge,getPreviousUrlWithParams:me,getTokenTimeToExpiry:fe,getUploadErrorMessage:function(e){const t=e?.message?.toLowerCase()||"",r=e?.response?.data;if(r?.error?.code){const e=r.error.code;if(Ne[e])return Ne[e]}return t.includes("file too large")||t.includes("413")?Ne[ve.FILE_TOO_LARGE]:t.includes("unsupported")||t.includes("invalid format")||t.includes("415")?Ne[ve.UNSUPPORTED_FORMAT]:t.includes("permission")||t.includes("unauthorized")||t.includes("401")||t.includes("403")?Ne[ve.PERMISSION_DENIED]:t.includes("network")||t.includes("fetch")||t.includes("timeout")||"NETWORK_ERROR"===e?.code?Ne[ve.NETWORK_ERROR]:t.includes("quota")||t.includes("storage full")||t.includes("429")?Ne[ve.QUOTA_EXCEEDED]:t.includes("post not found")||t.includes("invalid post")||t.includes("404")?Ne[ve.INVALID_POST]:"íŒŒì¼ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."},isAdmin:G,isRetryableError:function(e){const t=e?.message?.toLowerCase()||"",r=e?.response?.data?.error?.code;return![ve.FILE_TOO_LARGE,ve.UNSUPPORTED_FORMAT,ve.PERMISSION_DENIED,ve.QUOTA_EXCEEDED,ve.INVALID_POST].includes(r)&&!(t.includes("file too large")||t.includes("unsupported")||t.includes("invalid format")||t.includes("permission")||t.includes("unauthorized")||t.includes("quota"))},isTokenExpired:ye,keysToCamelCase:ce,keysToSnakeCase:le,logUploadError:function(e,t){const r={message:e?.message||"Unknown error",stack:e?.stack,response:e?.response?.data,context:t,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent};"development"===process.env.NODE_ENV&&(console.group("ğŸš¨ Upload Error"),console.error("Error Details:",r),console.groupEnd()),"production"===process.env.NODE_ENV&&console.error("Upload Error:",r)},normalizeImageSrc:ee,optimizeImageSrc:te,removeExpiredTokenFromCookie:be,shouldRefreshToken:xe,supabaseImageLoader:Z,timeAgo:j,toCamelCase:oe,toSnakeCase:ie,transformSupabaseImageUrl:Q,validateAndCleanToken:we});let ke={};function Te(e){ke={...ke,...e},e.development&&console.log("ğŸš€ @semicolon/community-core initialized with config:",ke)}function _e(){return Object.freeze({...ke})}const Ie=s(({variant:r="primary",size:n="md",loading:s=!1,fullWidth:a=!1,startIcon:o,endIcon:i,disabled:c,className:l="",children:d,...u},m)=>{const h=["inline-flex items-center justify-center font-medium transition-colors","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border-2 border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-gray-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[r],{sm:"px-3 py-1.5 text-sm rounded-md",md:"px-4 py-2 text-base rounded-lg",lg:"px-6 py-3 text-lg rounded-lg"}[n],a?"w-full":"",l].filter(Boolean).join(" ");return e("button",{ref:m,className:h,disabled:c||s,...u,children:[s&&t(()=>e("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[t("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),{}),!s&&o&&t("span",{className:"mr-2",children:o}),d,!s&&i&&t("span",{className:"ml-2",children:i})]})});Ie.displayName="Button";const Pe=({variant:r="primary",size:n="md",rounded:s=!1,dot:a=!1,className:o="",children:i,...c})=>{const l={primary:"bg-blue-400",secondary:"bg-gray-400",success:"bg-green-400",warning:"bg-yellow-400",danger:"bg-red-400",info:"bg-indigo-400"},d=[...["inline-flex items-center font-medium",s?"rounded-full":"rounded-md"],{primary:"bg-blue-100 text-blue-800",secondary:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-indigo-100 text-indigo-800"}[r],{sm:"px-2 py-1 text-xs",md:"px-2.5 py-1.5 text-sm",lg:"px-3 py-2 text-base"}[n],o].filter(Boolean).join(" ");return e("span",{className:d,...c,children:[a&&t(()=>t("span",{className:`w-2 h-2 rounded-full mr-1.5 ${l[r]}`,"aria-hidden":"true"}),{}),i]})},Ue=({src:r,name:n="",size:s="md",status:o,square:i=!1,className:c="",alt:l,...d})=>{const[u,m]=a(!1),[h,p]=a(!1),g=["inline-block relative",i?"rounded-lg":"rounded-full","bg-gray-100 overflow-hidden","ring-2 ring-white",{xs:"w-6 h-6 text-xs",sm:"w-8 h-8 text-sm",md:"w-10 h-10 text-base",lg:"w-12 h-12 text-lg",xl:"w-14 h-14 text-xl","2xl":"w-16 h-16 text-2xl"}[s]],y=r?ee(r):void 0,f=[...g,c].filter(Boolean).join(" ");return e("div",{className:f,children:[y&&!u?t("img",{src:y,alt:l||n,className:"w-full h-full object-cover",onError:()=>{m(!0)},onLoad:()=>{p(!0)},...d}):t("div",{className:"w-full h-full flex items-center justify-center bg-gray-300 text-gray-600 font-medium",children:(e=>e.split(" ").map(e=>e.charAt(0).toUpperCase()).join("").slice(0,2))(n)||"?"}),o&&t("span",{className:`absolute bottom-0 right-0 block ${{xs:"w-1.5 h-1.5",sm:"w-2 h-2",md:"w-2.5 h-2.5",lg:"w-3 h-3",xl:"w-3.5 h-3.5","2xl":"w-4 h-4"}[s]} ${{online:"bg-green-400",offline:"bg-gray-400",away:"bg-yellow-400",busy:"bg-red-400"}[o]} rounded-full ring-2 ring-white`,title:`Status: ${o}`,"aria-label":`User status: ${o}`})]})},Me=s(({label:r,error:n,helper:s,type:a="text",size:o="md",fullWidth:i=!1,startAdornment:c,endAdornment:l,className:d="",containerClassName:u="",labelClassName:m="",errorClassName:h="",helperClassName:p="",disabled:g=!1,required:y=!1,id:f,...b},w)=>{const x=f||`input-${Math.random().toString(36).substr(2,9)}`,v=`\n    \n    w-full\n    font-sans\n    text-gray-900\n    bg-white\n    border\n    rounded-lg\n    transition-all\n    duration-200\n    focus:outline-none\n    focus:ring-2\n    focus:ring-blue-500/20\n    disabled:opacity-50\n    disabled:cursor-not-allowed\n    disabled:bg-gray-50\n  \n    ${{sm:"h-8 px-2 text-sm",md:"h-10 px-3 text-sm",lg:"h-12 px-4 text-base"}[o]}\n    ${n?"border-red-500 focus:border-red-500":"border-gray-300 focus:border-blue-500 hover:border-gray-400"}\n    ${c?"pl-8":""}\n    ${l?"pr-8":""}\n    ${d}\n  `.trim().replace(/\s+/g," ");return e("div",{className:`${i?"w-full":"w-auto"} ${u}`,children:[r&&t("label",{htmlFor:x,className:`\n            block\n            text-sm\n            font-medium\n            text-gray-700\n            mb-2\n            font-sans\n            ${y?"after:content-['*'] after:text-red-500 after:ml-1":""}\n            ${g?"opacity-50":""}\n            ${m}\n          `.trim().replace(/\s+/g," "),children:r}),e("div",{className:"relative",children:[c&&t("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",children:c}),t("input",{ref:w,id:x,type:a,disabled:g,required:y,className:v,...b}),l&&t("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:l})]}),n&&t("p",{className:`\n          mt-2\n          text-sm\n          text-red-500\n          font-sans\n          ${h}\n        `.trim().replace(/\s+/g," "),children:n}),s&&!n&&t("p",{className:`\n          mt-2\n          text-sm\n          text-gray-500\n          font-sans\n          ${p}\n        `.trim().replace(/\s+/g," "),children:s})]})});Me.displayName="Input";const Ce=s(({options:r,value:n,onChange:s,placeholder:l="ì„ íƒí•´ì£¼ì„¸ìš”",disabled:d=!1,label:u,error:m,helper:h,size:p="md",fullWidth:g=!0,multiple:y=!1,searchable:f=!1,searchPlaceholder:b="ê²€ìƒ‰...",showIcon:w=!1,showDescription:x=!1,maxHeight:v="240px",noOptionsText:S="ì˜µì…˜ì´ ì—†ìŠµë‹ˆë‹¤",className:N="",dropdownClassName:E="",labelClassName:k="",errorClassName:T="",helperClassName:_=""},I)=>{const[P,U]=a(!1),[M,C]=a(""),A=o(null),$=`select-${Math.random().toString(36).substr(2,9)}`,O=i(()=>y?null:r.find(e=>e.value===n),[r,n,y]);c(()=>{const e=e=>{A.current&&!A.current.contains(e.target)&&(U(!1),C(""))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const L=`\n    \n    w-full\n    font-sans\n    bg-white\n    border\n    rounded-lg\n    transition-all\n    duration-200\n    focus:outline-none\n    focus:ring-2\n    focus:ring-blue-500/20\n    disabled:opacity-50\n    disabled:cursor-not-allowed\n    disabled:bg-gray-50\n    flex\n    items-center\n    justify-between\n    cursor-pointer\n  \n    ${{sm:"h-8 px-2 text-sm",md:"h-10 px-3 text-sm",lg:"h-12 px-4 text-base"}[p]}\n    ${m?"border-red-500 focus:border-red-500":"border-gray-300 focus:border-blue-500 hover:border-gray-400"}\n    ${N}\n  `.trim().replace(/\s+/g," ");return e("div",{ref:I,className:(g?"w-full":"w-auto")+" relative",children:[u&&t("label",{htmlFor:$,className:`\n            block\n            text-sm\n            font-medium\n            text-gray-700\n            mb-2\n            font-sans\n            ${d?"opacity-50":""}\n            ${k}\n          `.trim().replace(/\s+/g," "),children:u}),e("div",{ref:A,id:$,role:"button",tabIndex:d?-1:0,"aria-expanded":P,"aria-haspopup":"listbox",onClick:()=>{d||(U(!P),C(""))},className:L,children:[t("div",{className:"flex items-center gap-2 flex-1 overflow-hidden",children:t("span",O?{className:"truncate text-gray-900",children:O.label}:{className:"text-gray-500 truncate",children:l})}),t("svg",{className:"w-4 h-4 text-gray-400 transition-transform duration-200 flex-shrink-0 "+(P?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),P&&t("div",{className:`absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 overflow-hidden ${E}`,children:t("div",{className:"overflow-y-auto",style:{maxHeight:v},role:"listbox",children:0===r.length?t("div",{className:"px-3 py-8 text-center text-gray-500 text-sm",children:S}):r.map(r=>{const a=r.value===n;return t("button",{type:"button",role:"option","aria-selected":a,onClick:()=>(e=>{e.disabled||(s(e),y||(U(!1),C("")))})(r),disabled:r.disabled,className:`\n                      w-full px-3 py-2 text-left flex items-center gap-2 text-sm cursor-pointer\n                      transition-colors duration-150\n                      ${r.disabled?"opacity-50 cursor-not-allowed bg-gray-50":a?"bg-blue-50 text-blue-600":"hover:bg-gray-100 text-gray-900"}\n                      border-b border-gray-100 last:border-b-0\n                    `.trim().replace(/\s+/g," "),children:e("div",{className:"flex-1 min-w-0",children:[t("div",{className:"truncate",children:r.label}),x&&r.description&&t("div",{className:"text-xs text-gray-500 mt-1 truncate",children:r.description})]})},r.id)})})}),m&&t("p",{className:`\n          mt-2\n          text-sm\n          text-red-500\n          font-sans\n          ${T}\n        `.trim().replace(/\s+/g," "),children:m}),h&&!m&&t("p",{className:`\n          mt-2\n          text-sm\n          text-gray-500\n          font-sans\n          ${_}\n        `.trim().replace(/\s+/g," "),children:h})]})});Ce.displayName="Select";const Ae=s(({checked:r=!1,onChange:n,label:s,error:a,helper:o,size:i="md",indeterminate:c=!1,labelPosition:l="right",disabled:d=!1,className:u="",containerClassName:m="",labelClassName:h="",errorClassName:p="",helperClassName:g="",id:y,...f},b)=>{const w=y||`checkbox-${Math.random().toString(36).substr(2,9)}`,x=`\n    \n    text-blue-600\n    bg-white\n    border-2\n    rounded\n    transition-all\n    duration-200\n    focus:outline-none\n    focus:ring-2\n    focus:ring-blue-500/20\n    focus:border-blue-500\n    disabled:opacity-50\n    disabled:cursor-not-allowed\n    disabled:bg-gray-50\n  \n    ${{sm:"w-3 h-3",md:"w-4 h-4",lg:"w-5 h-5"}[i]}\n    ${a?"border-red-500":"border-gray-300 hover:border-blue-500"}\n    ${u}\n  `.trim().replace(/\s+/g," "),v=t("input",{ref:b,id:w,type:"checkbox",checked:r,onChange:e=>{n?.(e.target.checked,e)},disabled:d,className:x,...f}),S=s&&t("label",{htmlFor:w,className:`\n        text-gray-700\n        text-xs sm:text-sm\n        font-normal\n        font-sans\n        select-none\n        ${d?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n        ${h}\n      `.trim().replace(/\s+/g," "),children:s});return e("div",{className:m,children:[e("div",{className:"flex items-center gap-2 "+("left"===l?"flex-row-reverse":""),children:[v,S]}),a&&t("p",{className:`\n          mt-2\n          text-sm\n          text-red-500\n          font-sans\n          ${p}\n        `.trim().replace(/\s+/g," "),children:a}),o&&!a&&t("p",{className:`\n          mt-2\n          text-sm\n          text-gray-500\n          font-sans\n          ${g}\n        `.trim().replace(/\s+/g," "),children:o})]})});Ae.displayName="Checkbox";const $e=s(({checked:r=!1,onChange:n,name:s,value:a,label:o,error:i,helper:c,size:l="md",labelPosition:d="right",disabled:u=!1,className:m="",containerClassName:h="",labelClassName:p="",errorClassName:g="",helperClassName:y="",children:f,id:b,...w},x)=>{const v=b||`radio-${Math.random().toString(36).substr(2,9)}`,S=f||o,N=e("div",{className:"relative inline-flex items-center",children:[t("input",{ref:x,id:v,type:"radio",name:s,value:a,checked:r,onChange:e=>{n?.(e.target.value,e)},disabled:u,className:"sr-only",...w}),t("span",{className:`\n          flex-shrink-0 rounded-full flex items-center justify-center\n          border-2 transition-all duration-200\n          ${{sm:"w-3 h-3",md:"w-4 h-4",lg:"w-5 h-5"}[l]}\n          ${r?i?"border-red-500 bg-red-500":"border-blue-600 bg-blue-600":i?"border-red-500":"border-gray-300 hover:border-blue-600"}\n          ${u?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n          ${m}\n        `.trim().replace(/\s+/g," "),children:t("span",{className:`\n            rounded-full transition-all duration-200 bg-white\n            ${{sm:"w-1.5 h-1.5",md:"w-2.5 h-2.5",lg:"w-3 h-3"}[l]}\n            ${r?"opacity-100 scale-100":"opacity-0 scale-50"}\n          `.trim().replace(/\s+/g," ")})})]}),E=S&&t("label",{htmlFor:v,className:`\n        text-gray-700\n        text-xs sm:text-sm\n        font-normal\n        font-sans\n        whitespace-nowrap\n        select-none\n        ${u?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n        ${p}\n      `.trim().replace(/\s+/g," "),children:S});return e("div",{className:h,children:[e("div",{className:"inline-flex items-center gap-2 "+("left"===d?"flex-row-reverse":""),children:[N,E]}),i&&t("p",{className:`\n          mt-2\n          text-sm\n          text-red-500\n          font-sans\n          ${g}\n        `.trim().replace(/\s+/g," "),children:i}),c&&!i&&t("p",{className:`\n          mt-2\n          text-sm\n          text-gray-500\n          font-sans\n          ${y}\n        `.trim().replace(/\s+/g," "),children:c})]})});$e.displayName="Radio";const Oe=s(({checked:r=!1,onChange:n,label:s,error:a,helper:o,size:i="md",labelPosition:c="right",onText:l,offText:d,disabled:u=!1,className:m="",containerClassName:h="",labelClassName:p="",errorClassName:g="",helperClassName:y="",id:f,...b},w)=>{const x=f||`switch-${Math.random().toString(36).substr(2,9)}`,v={sm:{track:"w-8 h-4",thumb:"w-3 h-3",translate:"translate-x-4",text:"text-xs px-1"},md:{track:"w-10 h-5",thumb:"w-4 h-4",translate:"translate-x-5",text:"text-xs px-1.5"},lg:{track:"w-12 h-6",thumb:"w-5 h-5",translate:"translate-x-6",text:"text-sm px-2"}}[i],S=`\n    relative inline-flex items-center\n    ${v.track}\n    rounded-full\n    transition-colors duration-200 ease-in-out\n    focus-within:outline-none\n    focus-within:ring-2\n    focus-within:ring-blue-500/20\n    ${r?a?"bg-red-500":"bg-blue-600":a?"bg-red-200":"bg-gray-300"}\n    ${u?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n    ${m}\n  `.trim().replace(/\s+/g," "),N=`\n    inline-block\n    ${v.thumb}\n    bg-white\n    rounded-full\n    shadow\n    transform\n    transition-transform duration-200 ease-in-out\n    ${r?v.translate:"translate-x-0.5"}\n  `.trim().replace(/\s+/g," "),E=e("div",{className:"relative inline-flex",children:[t("input",{ref:w,id:x,type:"checkbox",checked:r,onChange:e=>{n?.(e.target.checked,e)},disabled:u,className:"sr-only",...b}),e("label",{htmlFor:x,className:S,children:[(l||d)&&t("span",{className:`\n            absolute inset-0 flex items-center justify-center\n            font-sans font-medium text-white\n            ${v.text}\n            pointer-events-none\n          `,children:r?l:d}),t("span",{className:N})]})]}),k=s&&t("label",{htmlFor:x,className:`\n        text-gray-700\n        text-xs sm:text-sm\n        font-normal\n        font-sans\n        select-none\n        ${u?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n        ${p}\n      `.trim().replace(/\s+/g," "),children:s});return e("div",{className:h,children:[e("div",{className:"inline-flex items-center gap-3 "+("left"===c?"flex-row-reverse":""),children:[E,k]}),a&&t("p",{className:`\n          mt-2\n          text-sm\n          text-red-500\n          font-sans\n          ${g}\n        `.trim().replace(/\s+/g," "),children:a}),o&&!a&&t("p",{className:`\n          mt-2\n          text-sm\n          text-gray-500\n          font-sans\n          ${y}\n        `.trim().replace(/\s+/g," "),children:o})]})});Oe.displayName="Switch";const Le=s(({label:r,error:n,helper:s,size:o="md",fullWidth:i=!1,autoResize:c=!1,minHeight:d=80,maxHeight:u=300,maxLength:m,showCount:h=!1,disabled:p=!1,required:g=!1,className:y="",containerClassName:f="",labelClassName:b="",errorClassName:w="",helperClassName:x="",countClassName:v="",value:S,onChange:N,id:E,...k},T)=>{const _=E||`textarea-${Math.random().toString(36).substr(2,9)}`,[I,P]=a(d),U=l(e=>{if(!c)return;e.style.height="auto";const t=e.scrollHeight,r=Math.min(Math.max(t,d),u);P(r),e.style.height=`${r}px`},[c,d,u]),M=`\n    \n    w-full\n    font-sans\n    text-gray-900\n    bg-white\n    border\n    rounded-lg\n    transition-all\n    duration-200\n    focus:outline-none\n    focus:ring-2\n    focus:ring-blue-500/20\n    disabled:opacity-50\n    disabled:cursor-not-allowed\n    disabled:bg-gray-50\n    resize-none\n  \n    ${{sm:"px-2 py-1.5 text-sm",md:"px-3 py-2 text-sm",lg:"px-4 py-3 text-base"}[o]}\n    ${n?"border-red-500 focus:border-red-500":"border-gray-300 focus:border-blue-500 hover:border-gray-400"}\n    ${c?"resize-none":"resize-y"}\n    ${y}\n  `.trim().replace(/\s+/g," "),C="string"==typeof S?S.length:0,A=!!m&&C>m;return e("div",{className:`${i?"w-full":"w-auto"} ${f}`,children:[e("div",{className:"flex justify-between items-center mb-2",children:[r&&t("label",{htmlFor:_,className:`\n              block\n              text-sm\n              font-medium\n              text-gray-700\n              font-sans\n              ${g?"after:content-['*'] after:text-red-500 after:ml-1":""}\n              ${p?"opacity-50":""}\n              ${b}\n            `.trim().replace(/\s+/g," "),children:r}),h&&(m||C>0)&&e("span",{className:`\n            text-sm\n            font-sans\n            ${A?"text-red-500":C/(m||100)>.8?"text-orange-500":"text-gray-500"}\n            ${v}\n          `.trim().replace(/\s+/g," "),children:[C,m&&`/${m}`]})]}),t("textarea",{ref:T,id:_,value:S,onChange:e=>{m&&e.target.value.length>m||(N?.(e),c&&U(e.target))},disabled:p,required:g,maxLength:m,className:M,style:c?{height:I,minHeight:d,maxHeight:u}:{minHeight:d},...k}),e("div",{className:"flex justify-between items-start mt-2",children:[e("div",{className:"flex-1",children:[n&&t("p",{className:`\n              text-sm\n              text-red-500\n              font-sans\n              ${w}\n            `.trim().replace(/\s+/g," "),children:n}),s&&!n&&t("p",{className:`\n              text-sm\n              text-gray-500\n              font-sans\n              ${x}\n            `.trim().replace(/\s+/g," "),children:s})]}),h&&!r&&(m||C>0)&&e("span",{className:`\n            text-sm\n            font-sans\n            ml-2\n            flex-shrink-0\n            ${A?"text-red-500":C/(m||100)>.8?"text-orange-500":"text-gray-500"}\n            ${v}\n          `.trim().replace(/\s+/g," "),children:[C,m&&`/${m}`]})]})]})});function Re({variant:e="rectangular",width:r,height:n,animated:s=!0,light:a=!1,className:o="",style:i,...c}){const l=a?"bg-gray-100":"bg-gray-200 dark:bg-gray-700",d={...(e=>{switch(e){case"rectangular":default:return{width:r||"100%",height:n||"1.2rem"};case"circular":return{width:r||"2.5rem",height:n||r||"2.5rem"};case"rounded":return{width:r||"100%",height:n||"1.5rem"};case"text":return{width:r||"100%",height:n||"1rem"}}})(e),...i};return t("div",{className:`\n        ${l}\n        ${{rectangular:"rounded-md",circular:"rounded-full",rounded:"rounded-lg",text:"rounded-sm"}[e]}\n        ${s?"animate-pulse":""}\n        ${o}\n      `.trim().replace(/\s+/g," "),style:d,...c})}Le.displayName="TextArea";const De=({lines:e=3,className:r="",...n})=>t("div",{className:`space-y-2 ${r}`,...n,children:Array.from({length:e}).map((r,n)=>t(Re,{variant:"text",width:n===e-1?"75%":"100%",height:"0.875rem"},n))}),Fe=({size:e="md",...r})=>{const n={sm:"2rem",md:"2.5rem",lg:"3rem",xl:"4rem"};return t(Re,{variant:"circular",width:n[e],height:n[e],...r})},Be=({variant:e="md",...r})=>{const n=(e=>{switch(e){case"sm":return{width:"4rem",height:"2rem"};case"lg":return{width:"8rem",height:"3rem"};default:return{width:"6rem",height:"2.5rem"}}})(e);return t(Re,{variant:"rounded",width:n.width,height:n.height,...r})},je=({...r})=>e("div",{className:"p-4 border border-gray-200 rounded-lg space-y-4",...r,children:[e("div",{className:"flex items-center space-x-3",children:[t(Fe,{size:"md"}),e("div",{className:"flex-1 space-y-2",children:[t(Re,{variant:"text",width:"60%"}),t(Re,{variant:"text",width:"40%"})]})]}),t(De,{lines:3}),e("div",{className:"flex space-x-2",children:[t(Be,{variant:"sm"}),t(Be,{variant:"sm"})]})]}),ze=process.env.NEXT_PUBLIC_API_URL,We=d.create({baseURL:ze,timeout:36e5,headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0});var Ve,qe;We.interceptors.request.use(async e=>{if(!e.metadata?.skipLoader){e.metadata;e.metadata}if(e.data instanceof FormData&&e.headers&&delete e.headers["Content-Type"],"undefined"!=typeof window)try{const t=document.cookie.split("; ").find(e=>e.startsWith("sb-access-token="))?.split("=")[1];if(t){const r=decodeURIComponent(t),n=JSON.parse(r),s=n?.access_token;if(s){const{decodeJWTPayload:t,isTokenExpired:r,removeExpiredTokenFromCookie:n}=await Promise.resolve().then(function(){return Se}),a=t(s);a&&!r(a)?e.headers&&(e.headers.Authorization=`Bearer ${s}`):(console.log("ğŸ—‘ï¸ axios ì¸í„°ì…‰í„°: ë§Œë£Œëœ í† í° ê°ì§€, ì¿ í‚¤ì—ì„œ ì œê±°"),n())}}}catch(e){try{const{removeExpiredTokenFromCookie:e}=await Promise.resolve().then(function(){return Se});e()}catch(e){console.error("JWT ìœ í‹¸ë¦¬í‹° import ì‹¤íŒ¨:",e)}}return e}),We.interceptors.response.use(async e=>{const t=e.config;if(t.metadata?.skipLoader||t.metadata,"N"===e.data?.successOrNot){const t=e.data?.statusCode,r=e.data?.message||e.data?.data;if("FORBIDDEN"===t&&"string"==typeof r&&(r.includes("í•´ë‹¹ ê²Œì‹œê¸€ì— ì ‘ê·¼í•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”")||r.includes("ë¡œê·¸ì¸ì´ í•„ìš”í•œ ê²Œì‹œê¸€")||r.includes("ë¡œê·¸ì¸ì´ í•„ìš”í•œ ê²Œì‹œíŒ"))){const{clientSupabase:e}=await Promise.resolve().then(function(){return jt}),{data:{session:t}}=await e.auth.getSession();if(!t||!t.access_token){const e=new CustomEvent("auth-error",{detail:{type:"AUTH_REQUIRED",message:r}});window.dispatchEvent(e)}}}return e},async e=>{e.config;if((401===e.response?.status||403===e.response?.status)&&!e.config._retried)try{console.log("ğŸ”„ axios: 401/403 ì—ëŸ¬ ê°ì§€, í† í° ê°±ì‹  ì‹œë„");const{clientSupabase:t}=await Promise.resolve().then(function(){return jt}),{data:{session:r},error:n}=await t.auth.getSession();if(n||!r)throw console.error("âŒ axios: ì„¸ì…˜ í™•ì¸ ì‹¤íŒ¨ ë˜ëŠ” ì„¸ì…˜ ì—†ìŒ"),new Error("ì„¸ì…˜ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");const{data:s,error:a}=await t.auth.refreshSession();if(a||!s.session)throw console.error("âŒ axios: í† í° ê°±ì‹  ì‹¤íŒ¨"),new Error("í† í° ê°±ì‹ ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");console.log("âœ… axios: í† í° ê°±ì‹  ì„±ê³µ");const o=e.config;return o._retried=!0,o.headers.Authorization=`Bearer ${s.session.access_token}`,console.log("ğŸ”„ axios: ê°±ì‹ ëœ í† í°ìœ¼ë¡œ ìš”ì²­ ì¬ì‹œë„"),We(o)}catch(e){console.error("âŒ axios: í† í° ê°±ì‹  ê³¼ì •ì—ì„œ ì˜¤ë¥˜:",e);const{clientSupabase:t}=await Promise.resolve().then(function(){return jt});await t.auth.signOut();const r=new CustomEvent("auth-error",{detail:{type:"TOKEN_INVALID"}});window.dispatchEvent(r)}return Promise.reject(e)}),function(e){e.SESSION_NAME="SESSION_NAME",e.YES_FLAG="Y",e.NO_FLAG="N",e.NA="NA"}(Ve||(Ve={})),function(e){e[e.SUCCESS=200]="SUCCESS",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.FAIL=400]="FAIL",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT"}(qe||(qe={}));class He{constructor(e="",t={}){this.baseUrl=e,this.defaultHeaders={"Content-Type":"application/json",...t}}handleError(e){if(e instanceof u){return{successOrNot:"N",statusCode:e.response?.status||qe.INTERNAL_SERVER_ERROR,message:e.response?.data?.message||e.message||"An error occurred",data:null}}return{successOrNot:"N",statusCode:qe.INTERNAL_SERVER_ERROR,message:e.message||"Unknown error occurred",data:null}}buildUrl(e){return e.startsWith("http")?e:`${this.baseUrl}${e.startsWith("/")?e:`/${e}`}`}prepareConfig(e){const t={headers:{...this.defaultHeaders,...e?.headers},params:e?.params,timeout:e?.timeout};return(e?.skipLoader||e?.useMiniLoader||e?.loaderText)&&(t.metadata={skipLoader:e.skipLoader,useMiniLoader:e.useMiniLoader,loaderText:e.loaderText}),t}async get(e,t){try{const r=this.buildUrl(e),n=this.prepareConfig(t);return(await We.get(r,n)).data}catch(e){return this.handleError(e)}}async post(e,t,r){try{const n=this.buildUrl(e),s=this.prepareConfig(r);return(await We.post(n,t,s)).data}catch(e){return this.handleError(e)}}async put(e,t,r){try{const n=this.buildUrl(e),s=this.prepareConfig(r);return(await We.put(n,t,s)).data}catch(e){return this.handleError(e)}}async patch(e,t,r){try{const n=this.buildUrl(e),s=this.prepareConfig(r);return(await We.patch(n,t,s)).data}catch(e){return this.handleError(e)}}async delete(e,t){try{const r=this.buildUrl(e),n=this.prepareConfig(t);return(await We.delete(r,n)).data}catch(e){return this.handleError(e)}}async getSilent(e,t){return this.get(e,{...t,skipLoader:!0})}async postSilent(e,t,r){return this.post(e,t,{...r,skipLoader:!0})}async putSilent(e,t,r){return this.put(e,t,{...r,skipLoader:!0})}async patchSilent(e,t,r){return this.patch(e,t,{...r,skipLoader:!0})}async deleteSilent(e,t){return this.delete(e,{...t,skipLoader:!0})}async getMini(e,t,r){return this.get(e,{...r,useMiniLoader:!0,loaderText:t})}async postMini(e,t,r,n){return this.post(e,t,{...n,useMiniLoader:!0,loaderText:r})}async putMini(e,t,r,n){return this.put(e,t,{...n,useMiniLoader:!0,loaderText:r})}async patchMini(e,t,r,n){return this.patch(e,t,{...n,useMiniLoader:!0,loaderText:r})}async deleteMini(e,t,r){return this.delete(e,{...r,useMiniLoader:!0,loaderText:t})}}const Ge={get:async e=>(new He).get(e),post:async(e,t)=>(new He).post(e,t),put:async(e,t)=>(new He).put(e,t),patch:async(e,t)=>(new He).patch(e,t),delete:async e=>(new He).delete(e),getSilent:async e=>(new He).getSilent(e),postSilent:async(e,t)=>(new He).postSilent(e,t),putSilent:async(e,t)=>(new He).putSilent(e,t),deleteSilent:async e=>(new He).deleteSilent(e),getMini:async(e,t)=>(new He).getMini(e,t),postMini:async(e,t,r)=>(new He).postMini(e,t,r),putMini:async(e,t,r)=>(new He).putMini(e,t,r),patchMini:async(e,t,r)=>(new He).patchMini(e,t,r),deleteMini:async(e,t)=>(new He).deleteMini(e,t)};class Je extends He{constructor(e){super(e?.baseUrl||"/api/user",e?.defaultHeaders)}async getMyInfo(){return this.getMini("/me","ì‚¬ìš©ì ì •ë³´ í™•ì¸ì¤‘...")}async getMyPermission(){return this.get("/me/permission")}async getMyPoint(){return this.getMini("/me/point","í¬ì¸íŠ¸ ì¡°íšŒì¤‘...")}async getRealtimeUser(){return this.getSilent("/realtime")}async getUserId(){return this.get("/id")}async getUserUuid(){return this.get("/uuid")}async updateUserProfile(e){return this.patch("/profile",e)}async refreshMyInfo(){return this.get("/me",{headers:{"Cache-Control":"no-cache"}})}async getUserInfo(e={}){const t={};return e.nickname&&(t.nickname=e.nickname),e.needPoint&&(t.needPoint="true"),e.includePermissions&&(t.includePermissions="true"),this.getMini("/","ì‚¬ìš©ì ì •ë³´ ì¡°íšŒì¤‘...",{params:t})}async checkUserIdExist(e){return this.post("/check/id",{userId:e})}async checkNicknameExist(e){return this.post("/check/nickname",{nickname:e})}async getUserById(e){return this.get(`/${e}`)}async getUsersByIds(e){return this.post("/batch",{userIds:e})}async searchUsers(e,t=1,r=10){return this.get("/search",{params:{keyword:e,page:t,pageSize:r}})}async updateUserLevel(e,t){return this.patch(`/${e}/level`,{level:t})}async updateUserBanStatus(e,t,r){return this.patch(`/${e}/ban-status`,{isBanned:t,reason:r})}}const Ke={getMyInfo:()=>(new Je).getMyInfo(),getMyPermission:()=>(new Je).getMyPermission(),getMyPoint:()=>(new Je).getMyPoint(),getRealtimeUser:()=>(new Je).getRealtimeUser(),getUserId:()=>(new Je).getUserId(),getUserUuid:()=>(new Je).getUserUuid(),updateUserProfile:e=>(new Je).updateUserProfile({profileImage:e}),refreshMyInfo:()=>(new Je).refreshMyInfo(),getUserInfo:(e,t=!1)=>(new Je).getUserInfo({nickname:e,needPoint:t}),checkUserIdExist:e=>(new Je).checkUserIdExist(e),checkNicknameExist:e=>(new Je).checkNicknameExist(e)};class Ye extends He{constructor(e){super(e?.baseUrl||"/api/post",e?.defaultHeaders)}async getPostList(e){const t={boardId:e.boardId.toString(),page:e.page.toString(),pageSize:(e.pageSize||10).toString(),sortBy:e.sortBy||"latest",searchType:e.searchType||"title",searchText:e.searchText||"",needNotice:(!1!==e.needNotice).toString()};return void 0!==e.categoryId&&null!==e.categoryId&&""!==e.categoryId&&(t.categoryId=e.categoryId.toString()),e.status&&(t.status=e.status),e.writerId&&(t.writerId=e.writerId.toString()),this.getMini("/","ê²Œì‹œê¸€ ëª©ë¡ ë¡œë”©ì¤‘...",{params:t})}async getPostById(e){return this.get(`/${e}`)}async createPost(e){const t=new FormData;return t.append("title",e.title),t.append("content",e.content),t.append("boardId",e.boardId.toString()),t.append("isNotice",(e.isNotice||!1).toString()),t.append("hasFiles",(e.hasFiles||!1).toString()),null!==e.categoryId&&void 0!==e.categoryId&&t.append("categoryId",e.categoryId.toString()),void 0!==e.downloadPoint&&null!==e.downloadPoint&&t.append("downloadPoint",e.downloadPoint.toString()),e.attachments&&e.attachments.length>0&&t.append("attachments",JSON.stringify(e.attachments)),e.metadata&&t.append("metadata",JSON.stringify(e.metadata)),e.files&&e.files.length>0&&e.files.forEach(e=>{t.append("files",e)}),this.postMini(`/${e.boardId}`,t,"ê²Œì‹œê¸€ ë“±ë¡ì¤‘...")}async updatePost(e,t){return this.putMini(`/${e}`,t,"ê²Œì‹œê¸€ ìˆ˜ì •ì¤‘...")}async deletePost(e){return this.deleteMini(`/${e}`,"ê²Œì‹œê¸€ ì‚­ì œì¤‘...")}async reactToPost(e,t){const r="like"===t?"ì¶”ì²œ ì²˜ë¦¬ì¤‘...":"ë¹„ì¶”ì²œ ì²˜ë¦¬ì¤‘...";return this.postMini(`/${e}/reaction`,{reactionType:t},r)}async purchaseFiles(e){return this.postMini(`/${e}/purchase`,{},"íŒŒì¼ êµ¬ë§¤ ì²˜ë¦¬ì¤‘...")}async bookmarkPost(e){return this.postMini(`/${e}/bookmark`,{},"ë¶ë§ˆí¬ ì²˜ë¦¬ì¤‘...")}async removeBookmark(e){return this.deleteMini(`/${e}/bookmark`,"ë¶ë§ˆí¬ ì‚­ì œì¤‘...")}async getBookmarkedPosts(){return this.getMini("/bookmarks","ë¶ë§ˆí¬ëœ ê²Œì‹œê¸€ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...")}async movePost(e,t){return this.patchMini(`/${e}`,{board_id:t},"ê²Œì‹œê¸€ ì´ë™ì¤‘...")}async createDraftPost(e){return this.postMini("/draft",e,"ê²Œì‹œê¸€ ì´ˆì•ˆ ìƒì„±ì¤‘...")}async publishPost(e){return this.putMini(`/${e}/publish`,{},"ê²Œì‹œê¸€ ë°œí–‰ì¤‘...")}async startAsyncFileUpload(e,t,r){const n=new FormData;n.append("postId",e.toString()),n.append("needWatermark",(!1!==r?.needWatermark).toString()),n.append("watermarkPosition",r?.watermarkPosition||"bottom-right"),n.append("watermarkOpacity",(r?.watermarkOpacity||.7).toString()),t.forEach(e=>{n.append("files",e)});const s=await this.postMini("/upload-async",n,"íŒŒì¼ ì—…ë¡œë“œ ì‹œì‘ì¤‘...");if(s.data&&!s.data.success)throw new Error(s.data.message);return{...s,data:s.data?.data||null}}async getUploadProgress(e){const t=await this.getSilent(`/upload-progress/${e}`);if(t.data&&!t.data.success)throw new Error(t.data.message||"ì§„í–‰ë„ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤");return{...t,data:t.data?.data||null}}async retryFailedFiles(e,t){return this.postMini(`/retry-upload/${e}`,{failedFileUuids:t},"ì‹¤íŒ¨í•œ íŒŒì¼ ì¬ì—…ë¡œë“œ ì¤‘...")}async cancelUpload(e){return this.deleteMini(`/cancel-upload/${e}`,"ì—…ë¡œë“œ ì·¨ì†Œì¤‘...")}async createPostAsync(e){const t=await this.createDraftPost({title:e.title,content:e.content,boardId:e.boardId,categoryId:e.categoryId||void 0});return"Y"===t.successOrNot&&t.data?(e.files&&e.files.length>0?await this.startAsyncFileUpload(t.data.id,e.files):await this.publishPost(t.data.id),t):t}async getDraftPosts(e={}){const t={status:"draft",page:(e.page||1).toString(),pageSize:(e.pageSize||10).toString(),sortBy:e.sortBy||"latest"};return e.writerId&&(t.writerId=e.writerId.toString()),this.getSilent("/",{params:t})}async searchPosts(e,t=1,r=10,n){const s={keyword:e,page:t.toString(),pageSize:r.toString()};return n&&n.length>0&&(s.boardIds=n.join(",")),this.get("/search",{params:s})}async getPostStats(e){const t=e?{boardId:e.toString()}:{};return this.get("/stats",{params:t})}}const Qe={getPost:e=>(new Ye).getPostList(e),createPost:e=>(new Ye).createPost(e),reactionPost:(e,t)=>(new Ye).reactToPost(e,t),deletePost:e=>(new Ye).deletePost(e),updatePost:(e,t)=>(new Ye).updatePost(e,t),purchaseFiles:e=>(new Ye).purchaseFiles(e),bookmarkPost:e=>(new Ye).bookmarkPost(e),deleteBookmarkPost:e=>(new Ye).removeBookmark(e),getBookmarkPosts:()=>(new Ye).getBookmarkedPosts(),movePost:(e,t)=>(new Ye).movePost(e,t),createDraftPost:e=>(new Ye).createDraftPost(e),publishPost:e=>(new Ye).publishPost(e),getDraftPosts:(e={})=>(new Ye).getDraftPosts(e),startAsyncFileUpload:(e,t,r)=>(new Ye).startAsyncFileUpload(e,t,r),getUploadProgress:e=>(new Ye).getUploadProgress(e),retryFailedFiles:(e,t)=>(new Ye).retryFailedFiles(e,t),cancelUpload:e=>(new Ye).cancelUpload(e),createPostAsync:e=>(new Ye).createPostAsync(e)};class Xe extends He{constructor(e){super(e?.baseUrl||"/api/boards",e?.defaultHeaders)}async getBoards(e={}){const t={};return e.page&&(t.page=e.page.toString()),e.pageSize&&(t.pageSize=e.pageSize.toString()),e.sortBy&&(t.sortBy=e.sortBy),e.searchText&&(t.searchText=e.searchText),e.searchType&&(t.searchType=e.searchType),void 0!==e.isActive&&(t.isActive=e.isActive.toString()),e.categoryId&&(t.categoryId=e.categoryId.toString()),this.getMini("/","ê²Œì‹œíŒ ëª©ë¡ ë¡œë”©ì¤‘...",{params:t})}async getBoard(e){return this.getMini(`/${e}`,"ê²Œì‹œíŒ ì •ë³´ ë¡œë”©ì¤‘...")}async createBoard(e){return this.postMini("/",e,"ê²Œì‹œíŒ ìƒì„±ì¤‘...")}async updateBoard(e,t){return this.putMini(`/${e}`,t,"ê²Œì‹œíŒ ìˆ˜ì •ì¤‘...")}async deleteBoard(e){return this.deleteMini(`/${e}`,"ê²Œì‹œíŒ ì‚­ì œì¤‘...")}async getBoardCategories(e){return this.getMini(`/${e}/categories`,"ì¹´í…Œê³ ë¦¬ ë¡œë”©ì¤‘...")}async createBoardCategory(e,t){return this.postMini(`/${e}/categories`,t,"ì¹´í…Œê³ ë¦¬ ìƒì„±ì¤‘...")}async updateBoardCategory(e,t,r){return this.putMini(`/${e}/categories/${t}`,r,"ì¹´í…Œê³ ë¦¬ ìˆ˜ì •ì¤‘...")}async deleteBoardCategory(e,t){return this.deleteMini(`/${e}/categories/${t}`,"ì¹´í…Œê³ ë¦¬ ì‚­ì œì¤‘...")}async getBoardStats(e){return this.getSilent(`/${e}/stats`)}async searchBoards(e,t=1,r=10){return this.get("/search",{params:{keyword:e,page:t.toString(),pageSize:r.toString()}})}async getPopularBoards(e=10){return this.getSilent("/popular",{params:{limit:e.toString()}})}async getRecentlyActiveBoards(e=10){return this.getSilent("/recent-activity",{params:{limit:e.toString()}})}async getFavoriteBoards(){return this.getMini("/favorites","ì¦ê²¨ì°¾ê¸° ê²Œì‹œíŒ ë¡œë”©ì¤‘...")}async addToFavorites(e){return this.postMini(`/${e}/favorite`,{},"ì¦ê²¨ì°¾ê¸° ì¶”ê°€ì¤‘...")}async removeFromFavorites(e){return this.deleteMini(`/${e}/favorite`,"ì¦ê²¨ì°¾ê¸° ì œê±°ì¤‘...")}async getBoardPermissions(e){return this.getSilent(`/${e}/permissions`)}async updateBoardPermissions(e,t){return this.patchMini(`/${e}/permissions`,t,"ê¶Œí•œ ì„¤ì • ì—…ë°ì´íŠ¸ ì¤‘...")}async getBoardModerators(e){return this.get(`/${e}/moderators`)}async addBoardModerator(e,t){return this.postMini(`/${e}/moderators`,{userId:t},"ëª¨ë”ë ˆì´í„° ì¶”ê°€ì¤‘...")}async removeBoardModerator(e,t){return this.deleteMini(`/${e}/moderators/${t}`,"ëª¨ë”ë ˆì´í„° ì œê±°ì¤‘...")}async reportBoard(e,t,r){return this.postMini(`/${e}/report`,{reason:t,description:r},"ì‹ ê³  ì ‘ìˆ˜ì¤‘...")}async getBoardActivity(e,t=1,r=20){return this.get(`/${e}/activity`,{params:{page:t.toString(),pageSize:r.toString()}})}}const Ze={getBoards:()=>(new Xe).getBoards(),getBoard:e=>(new Xe).getBoard(e),getBoardCategories:e=>(new Xe).getBoardCategories(e)};class et extends He{constructor(e){super(e?.baseUrl||"/api/auth",e?.defaultHeaders)}async login(e){return this.postMini("/login",e,"ë¡œê·¸ì¸ ì¤‘...")}async logout(){return this.postMini("/logout",{},"ë¡œê·¸ì•„ì›ƒ ì¤‘...")}async register(e){return this.postMini("/register",e,"íšŒì›ê°€ì… ì²˜ë¦¬ ì¤‘...")}async refreshToken(e){return this.postSilent("/refresh",{refreshToken:e})}async validateSession(){return this.getSilent("/validate")}async getCurrentUser(){return this.getMini("/me","ì‚¬ìš©ì ì •ë³´ í™•ì¸ ì¤‘...")}async requestPasswordReset(e){return this.postMini("/password-reset/request",e,"ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ìš”ì²­ ì¤‘...")}async resetPassword(e,t,r){return this.postMini("/password-reset/confirm",{token:e,newPassword:t,newPasswordConfirm:r},"ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì¤‘...")}async changePassword(e){return this.putMini("/password",e,"ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì¤‘...")}async sendEmailVerification(e){return this.postMini("/verify-email/send",{email:e},"ì¸ì¦ ë©”ì¼ ë°œì†¡ ì¤‘...")}async verifyEmail(e){return this.postMini("/verify-email/confirm",{token:e},"ì´ë©”ì¼ ì¸ì¦ ì¤‘...")}async checkUserIdAvailability(e){return this.get("/check/userid",{params:{userId:e}})}async checkNicknameAvailability(e){return this.get("/check/nickname",{params:{nickname:e}})}async checkEmailAvailability(e){return this.get("/check/email",{params:{email:e}})}async getUserSessions(){return this.get("/sessions")}async revokeSession(e){return this.deleteMini(`/sessions/${e}`,"ì„¸ì…˜ í•´ì œ ì¤‘...")}async revokeAllSessions(){return this.deleteMini("/sessions/all","ëª¨ë“  ì„¸ì…˜ í•´ì œ ì¤‘...")}async enable2FA(){return this.postMini("/2fa/enable",{},"2FA ì„¤ì • ì¤‘...")}async confirm2FA(e){return this.postMini("/2fa/confirm",{code:e},"2FA ì¸ì¦ ì¤‘...")}async disable2FA(e){return this.deleteMini("/2fa/disable","2FA í•´ì œ ì¤‘...")}async verify2FACode(e){return this.postMini("/2fa/verify",{code:e},"2FA ì½”ë“œ í™•ì¸ ì¤‘...")}}const tt={login:e=>(new et).login(e),logout:()=>(new et).logout(),register:e=>(new et).register(e),refreshToken:e=>(new et).refreshToken(e),validateSession:()=>(new et).validateSession(),getCurrentUser:()=>(new et).getCurrentUser(),requestPasswordReset:e=>(new et).requestPasswordReset(e),resetPassword:(e,t,r)=>(new et).resetPassword(e,t,r),changePassword:e=>(new et).changePassword(e),sendEmailVerification:e=>(new et).sendEmailVerification(e),verifyEmail:e=>(new et).verifyEmail(e),checkUserIdAvailability:e=>(new et).checkUserIdAvailability(e),checkNicknameAvailability:e=>(new et).checkNicknameAvailability(e),checkEmailAvailability:e=>(new et).checkEmailAvailability(e)};class rt extends He{constructor(e){super(e?.baseUrl||"/api/permissions",e?.defaultHeaders)}async checkPermission(e){return this.getSilent("/check",{params:{resource:e.resource,action:e.action,context:e.context?JSON.stringify(e.context):void 0}})}async checkPermissions(e){return this.postSilent("/check-multiple",{checks:e})}async getMyPermissions(){return this.getMini("/me","ê¶Œí•œ ì •ë³´ ì¡°íšŒ ì¤‘...")}async getUserPermissions(e){return this.get(`/users/${e}`)}async getLevels(){return this.getSilent("/levels")}async getLevel(e){return this.get(`/levels/${e}`)}async updateUserLevel(e,t,r){return this.patchMini(`/users/${e}/level`,{level:t,reason:r},"ì‚¬ìš©ì ë ˆë²¨ ë³€ê²½ ì¤‘...")}async getRoles(){return this.get("/roles")}async getRole(e){return this.get(`/roles/${e}`)}async createRole(e){return this.postMini("/roles",e,"ì—­í•  ìƒì„± ì¤‘...")}async updateRole(e,t){return this.putMini(`/roles/${e}`,t,"ì—­í•  ìˆ˜ì • ì¤‘...")}async deleteRole(e){return this.deleteMini(`/roles/${e}`,"ì—­í•  ì‚­ì œ ì¤‘...")}async assignRole(e,t,r){return this.postMini(`/users/${e}/roles`,{roleId:t,reason:r},"ì—­í•  í• ë‹¹ ì¤‘...")}async removeRole(e,t,r){return this.deleteMini(`/users/${e}/roles/${t}`,"ì—­í•  ì œê±° ì¤‘...")}async grantPermission(e){return this.postMini("/grants",e,"ê¶Œí•œ ë¶€ì—¬ ì¤‘...")}async revokePermission(e,t,r,n){return this.deleteMini(`/grants/${e}/${t}`,"ê¶Œí•œ íšŒìˆ˜ ì¤‘...")}async getUserGrants(e){return this.get(`/grants/users/${e}`)}async getPermissionHistory(e,t=1,r=20){return this.get(`/history/${e}`,{params:{page:t.toString(),pageSize:r.toString()}})}async checkBoardAccess(e,t="read"){return this.checkPermission({resource:"board",action:t,context:{boardId:e}})}async checkPostAccess(e,t="read"){return this.checkPermission({resource:"post",action:t,context:{postId:e}})}async checkAdminAccess(e="system"){return this.checkPermission({resource:"admin",action:"access",context:{section:e}})}async getLevelProgression(e){const t=e?`/progression/${e}`:"/progression/me";return this.getMini(t,"ë ˆë²¨ ì •ë³´ ì¡°íšŒ ì¤‘...")}async updateUserBanStatus(e,t,r,n){return this.patchMini(`/users/${e}/ban`,{banned:t,reason:r,duration:n},t?"ì‚¬ìš©ì ì œì¬ ì¤‘...":"ì‚¬ìš©ì ì œì¬ í•´ì œ ì¤‘...")}async getUserRestrictions(e){return this.get(`/users/${e}/restrictions`)}}const nt={checkPermission:e=>(new rt).checkPermission(e),getMyPermissions:()=>(new rt).getMyPermissions(),getLevels:()=>(new rt).getLevels(),checkBoardAccess:(e,t="read")=>(new rt).checkBoardAccess(e,t),checkAdminAccess:(e="system")=>(new rt).checkAdminAccess(e)};var st,at={exports:{}},ot={};var it,ct={};
/**
 * @license React
 * use-sync-external-store-with-selector.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */"production"===process.env.NODE_ENV?at.exports=function(){if(st)return ot;st=1;var e=n,t="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=e.useSyncExternalStore,s=e.useRef,a=e.useEffect,o=e.useMemo,i=e.useDebugValue;return ot.useSyncExternalStoreWithSelector=function(e,n,c,l,d){var u=s(null);if(null===u.current){var m={hasValue:!1,value:null};u.current=m}else m=u.current;u=o(function(){function e(e){if(!a){if(a=!0,r=e,e=l(e),void 0!==d&&m.hasValue){var n=m.value;if(d(n,e))return s=n}return s=e}if(n=s,t(r,e))return n;var o=l(e);return void 0!==d&&d(n,o)?(r=e,n):(r=e,s=o)}var r,s,a=!1,o=void 0===c?null:c;return[function(){return e(n())},null===o?void 0:function(){return e(o())}]},[n,c,l,d]);var h=r(e,u[0],u[1]);return a(function(){m.hasValue=!0,m.value=h},[h]),i(h),h},ot}():at.exports=(it||(it=1,"production"!==process.env.NODE_ENV&&function(){"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var e=n,t="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=e.useSyncExternalStore,s=e.useRef,a=e.useEffect,o=e.useMemo,i=e.useDebugValue;ct.useSyncExternalStoreWithSelector=function(e,n,c,l,d){var u=s(null);if(null===u.current){var m={hasValue:!1,value:null};u.current=m}else m=u.current;u=o(function(){function e(e){if(!a){if(a=!0,r=e,e=l(e),void 0!==d&&m.hasValue){var n=m.value;if(d(n,e))return s=n}return s=e}if(n=s,t(r,e))return n;var o=l(e);return void 0!==d&&d(n,o)?(r=e,n):(r=e,s=o)}var r,s,a=!1,o=void 0===c?null:c;return[function(){return e(n())},null===o?void 0:function(){return e(o())}]},[n,c,l,d]);var h=r(e,u[0],u[1]);return a(function(){m.hasValue=!0,m.value=h},[h]),i(h),h},"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()),ct);var lt=at.exports,dt=Symbol.for("react-redux-context"),ut="undefined"!=typeof globalThis?globalThis:{};function mt(){if(!r.createContext)return{};const e=ut[dt]??=new Map;let t=e.get(r.createContext);return t||(t=r.createContext(null),"production"!==process.env.NODE_ENV&&(t.displayName="ReactRedux"),e.set(r.createContext,t)),t}var ht=mt();function pt(e=ht){return function(){const t=r.useContext(e);if("production"!==process.env.NODE_ENV&&!t)throw new Error("could not find react-redux context value; please ensure the component is wrapped in a <Provider>");return t}}var gt=pt();function yt(e=ht){const t=e===ht?gt:pt(e),r=()=>{const{store:e}=t();return e};return Object.assign(r,{withTypes:()=>r}),r}var ft=yt();function bt(e=ht){const t=e===ht?ft:yt(e),r=()=>t().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var wt=bt(),xt=(e,t)=>e===t;function vt(e=ht){const t=e===ht?gt:pt(e),n=(e,n={})=>{const{equalityFn:s=xt}="function"==typeof n?{equalityFn:n}:n;if("production"!==process.env.NODE_ENV){if(!e)throw new Error("You must pass a selector to useSelector");if("function"!=typeof e)throw new Error("You must pass a function as a selector to useSelector");if("function"!=typeof s)throw new Error("You must pass a function as an equality function to useSelector")}const a=t(),{store:o,subscription:i,getServerState:c}=a,l=r.useRef(!0),d=r.useCallback({[e.name](t){const r=e(t);if("production"!==process.env.NODE_ENV){const{devModeChecks:o={}}="function"==typeof n?{}:n,{identityFunctionCheck:i,stabilityCheck:c}=a,{identityFunctionCheck:d,stabilityCheck:u}={stabilityCheck:c,identityFunctionCheck:i,...o};if("always"===u||"once"===u&&l.current){const n=e(t);if(!s(r,n)){let s;try{throw new Error}catch(e){({stack:s}=e)}console.warn("Selector "+(e.name||"unknown")+" returned a different result when called with the same parameters. This can lead to unnecessary rerenders.\nSelectors that return a new reference (such as an object or an array) should be memoized: https://redux.js.org/usage/deriving-data-selectors#optimizing-selectors-with-memoization",{state:t,selected:r,selected2:n,stack:s})}}if(("always"===d||"once"===d&&l.current)&&r===t){let t;try{throw new Error}catch(e){({stack:t}=e)}console.warn("Selector "+(e.name||"unknown")+" returned the root state when called. This can lead to unnecessary rerenders.\nSelectors that return the entire state are almost certainly a mistake, as they will cause a rerender whenever *anything* in state changes.",{stack:t})}l.current&&(l.current=!1)}return r}}[e.name],[e]),u=lt.useSyncExternalStoreWithSelector(i.addNestedSub,o.getState,c||o.getState,d,s);return r.useDebugValue(u),u};return Object.assign(n,{withTypes:()=>n}),n}var St=vt();const Nt=()=>{const e=wt(),t=St(e=>e.app.deviceType);c(()=>{const t=()=>{e(m(window.innerWidth))};return t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[e]);return{deviceType:t,isMobile:"mobile"===t,isTablet:"tablet"===t,isDesktop:"desktop"===t,isMobileOrTablet:"mobile"===t||"tablet"===t}},Et=()=>{const e=_t(),{isAutoTransitioned:t}=It(h),r=l(t=>{e(p(t))},[e]),n=l(()=>{e(g())},[e]),s=l(t=>{e(y(t))},[e]),a=l(async e=>{try{r();return await e()}finally{n()}},[r,n]),o=l(t=>{e(f(t))},[e]),i=l(()=>{e(t?b():w())},[e,t]),c=l(t=>{e(x(t))},[e]),d=l(async e=>{try{o();return await e()}finally{i()}},[o,i]),u=l(t=>{e(p(t))},[e]),m=l(()=>{e(g())},[e]),v=l(t=>{e(y(t))},[e]),S=l(async e=>{try{u();return await e()}finally{m()}},[u,m]);return{showLoader:r,hideLoader:n,withLoader:a,setLoaderText:s,showPostLoader:o,hidePostLoader:i,withPostLoader:d,setPostLoaderText:c,showMiniLoader:u,hideMiniLoader:m,withMiniLoader:S,setMiniLoaderText:v}},kt=()=>{const e=_t(),t=It(E),r=t?.userInfo,[n,s]=a(null),o=r||n,i=I(o),d=P(o),u=t?.isLoggedIn||!!n;c(()=>{(async()=>{if(r)s(null);else try{const e=await C();s(e)}catch(e){s(null)}})()},[r]);return{checkPermission:l(e=>void 0===e||(r?U(r,e):n?(console.warn("Redux storeì— ì‚¬ìš©ì ì •ë³´ê°€ ì—†ì–´ JWT í† í° ì •ë³´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤."),U(n,e)):0===e),[r,n]),showAccessDeniedToast:l(()=>{e(N({title:"ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.",content:"í•´ë‹¹ ë©”ë‰´ì— ì ‘ê·¼í•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.",headerTextColor:"text-red-500"}))},[e]),userLevel:i,isAdmin:d,isLoggedIn:u,currentUser:o}},Tt=()=>{const e=v(),t=S(),{showMiniLoader:r,hideMiniLoader:n}=Et();c(()=>{n()},[t,n]);const s=l(e=>{try{let r,n=!1;if(e.startsWith("http")){const t=new URL(e),s=window.location.hostname;n=t.hostname!==s,r=t.pathname}else r=e.split("?")[0].split("#")[0];return!n&&r!==t}catch{return!e.startsWith("http")}},[t]),a=l((t,n)=>(s(t)&&r("í˜ì´ì§€ë¥¼ ì´ë™í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤."),e.push(t,n)),[e,r,s]),o=l((t,n)=>(s(t)&&r("í˜ì´ì§€ë¥¼ ì´ë™í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤."),e.replace(t,n)),[e,r,s]);return{...e,push:a,replace:o}},_t=()=>wt(),It=St,Pt=()=>{const e=_t(),t=It(E),{withLoader:r,showLoader:n,hideLoader:s}=Et(),a=Tt(),o=l(async t=>r(async()=>{const r=await e(k(t));if(k.fulfilled.match(r))return e(N({title:"ë¡œê·¸ì¸ ì„±ê³µ",content:`í™˜ì˜í•©ë‹ˆë‹¤, ${r.payload.nickname}ë‹˜!`,headerTextColor:"text-green-500"})),{success:!0,user:r.payload};{const t=r.payload?.result||"ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";return e(N({title:"ë¡œê·¸ì¸ ì‹¤íŒ¨",content:t,headerTextColor:"text-red-500"})),{success:!1,error:t}}}),[e,r]),i=l(async()=>r(async()=>{const t=await e(T());if(T.fulfilled.match(t))return e(N({title:"ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ",content:"ì•ˆì „í•˜ê²Œ ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.",headerTextColor:"text-blue-500"})),a.push("/"),{success:!0};{const r=t.payload?.result||"ë¡œê·¸ì•„ì›ƒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";return e(N({title:"ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨",content:r,headerTextColor:"text-red-500"})),{success:!1,error:r}}}),[e,r,a]),c=l(async()=>{try{n("ì¸ì¦ ì •ë³´ë¥¼ í™•ì¸í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤...");const t=await e(_());return _.fulfilled.match(t)?{success:!0,user:t.payload}:{success:!1,error:t.payload?.result}}finally{s()}},[e,n,s]),d=l(async()=>{try{const{getCurrentUserFromToken:e,isTokenExpired:t}=await import("@util/jwtUtil"),r=await e();return r?t(r)?{valid:!1,reason:"EXPIRED"}:{valid:!0,user:r}:{valid:!1,reason:"NO_TOKEN"}}catch(e){return console.error("ì„¸ì…˜ í™•ì¸ ì‹¤íŒ¨:",e),{valid:!1,reason:"ERROR"}}},[]),u=l(async(t,r,n)=>{const s=await d();return s.valid?n&&s.user&&!s.user.is_admin?(e(N({title:"ê¶Œí•œ ë¶€ì¡±",content:"ê´€ë¦¬ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",headerTextColor:"text-red-500"})),!1):(a.push(t),!0):(e(N({title:"ë¡œê·¸ì¸ í•„ìš”",content:"ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.",headerTextColor:"text-orange-500"})),!1)},[d,e,a]);return{userState:t,isLoggedIn:t.isLoggedIn,user:t.userInfo,error:t.error,loginWithLoader:o,logoutWithLoader:i,initializeAuth:c,checkSession:d,navigateWithAuth:u,isAdmin:()=>("admin"===t.userInfo?.permissionType||"super_admin"===t.userInfo?.permissionType)&&(t.userInfo?.level??0)>=99,isUser:()=>t.isLoggedIn&&t.userInfo}},Ut=(e={})=>{const t=It(E),{userInfo:r,isLoggedIn:n}=t,[s,i]=a(!0),[d,u]=a(null),[m,h]=a(null),p=o(!1),g=o(null),y=l(async()=>{try{const{validateAndCleanToken:e}=await import("@util/jwtUtil"),t=await e();if(!t)return u("LOGIN_REQUIRED"),!1;const r=JSON.stringify(t);return g.current!==r&&(g.current=r,h(t)),!0}catch(e){console.error("í† í° ì¸ì¦ í™•ì¸ ì‹¤íŒ¨:",e),u("TOKEN_INVALID");const{removeExpiredTokenFromCookie:t}=await import("@util/jwtUtil");return t(),!1}},[]),f=l(t=>{if(e.adminOnly&&!P(t))return u("ADMIN_ONLY"),!1;if(void 0!==e.requiredLevel&&!U(t,e.requiredLevel))return u("INSUFFICIENT_PERMISSION"),!1;if(e.boardPermissions){const r=e.boardPermissions.writeLevel,n=e.boardPermissions.readLevel;if(void 0!==r&&!M(t,r,!0))return u("INSUFFICIENT_PERMISSION"),!1;if(void 0!==n&&!M(t,n,!0))return u("INSUFFICIENT_PERMISSION"),!1}return!0},[e.adminOnly,e.requiredLevel,e.boardPermissions]),b=l(async()=>{if(p.current)return!1;p.current=!0,i(!0),u(null);try{if(n&&r){return f(r)}if(!await y())return!1;if(!m)return u("LOGIN_REQUIRED"),!1;console.warn("Redux storeì— ì‚¬ìš©ì ì •ë³´ê°€ ì—†ì–´ JWT í† í° ì •ë³´ë¡œ ê¶Œí•œ ì²´í¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.");return f(m)}catch(e){return console.error("ê¶Œí•œ ì²´í¬ ì‹¤íŒ¨:",e),u("TOKEN_INVALID"),!1}finally{i(!1),p.current=!1}},[y,f,n,r,m]);c(()=>{b()},[]),c(()=>{if(n&&r&&!p.current){f(r)?(i(!1),u(null)):i(!1)}},[n,r,f]);const w=r||m,x=n&&!!w;return{isAuthenticated:x,hasPermission:x&&!d,isLoading:s,user:w,errorType:d,checkPermissionAsync:b}},Mt=e=>$({queryKey:["userPoint",e],queryFn:()=>A.getUserPoint(e),staleTime:18e4,gcTime:36e5,retry:3,select:e=>{if("Y"===e.successOrNot&&e.data)return e.data;throw new Error("Failed to fetch user point")}}),Ct=e=>$({queryKey:["userPointHistory",e],queryFn:()=>A.getUserPointHistory(e)}),At=(e,t)=>$({queryKey:["post",e],queryFn:()=>Ye.getPost(e),staleTime:1e4,gcTime:864e5,retry:3,enabled:t?.enabled,placeholderData:e=>e,refetchOnMount:!1,select:e=>"N"===e.successOrNot?{data:{items:[],totalCount:0,notices:[]}}:e.data?{data:{items:e.data.items.map(e=>({...e,created_at:O(e.created_at||(new Date).toISOString())})),totalCount:e.data.totalCount,notices:e.data.notices}}:{data:{items:[],totalCount:0,notices:[]}}}),$t=()=>$({queryKey:["postBookmark"],queryFn:()=>Ye.getBookmarkPosts(),staleTime:3e4,gcTime:864e5,retry:3,select:e=>"N"===e.successOrNot?{data:[]}:e.data}),Ot=(e={},t={enabled:!0,enablePolling:!1})=>$({queryKey:["draftPost",e],queryFn:()=>Ye.getDraftPosts(e),staleTime:0,gcTime:3e5,retry:3,enabled:t?.enabled,refetchInterval:e=>{if(!t?.enablePolling)return!1;const r=e.state.data;if(r&&r.data&&Array.isArray(r.data)){if(r.data.every(e=>!e.attachments||0===e.attachments.length||e.attachments.every(e=>"uploaded"===e.status)))return console.log("âœ… ëª¨ë“  íŒŒì¼ ì—…ë¡œë“œê°€ ì™„ë£Œë˜ì–´ í´ë§ì„ ì¤‘ì§€í•©ë‹ˆë‹¤."),!1}return 2e3},refetchIntervalInBackground:!1,select:e=>"N"===e.successOrNot?{data:{items:[],totalCount:0,notices:[]}}:e.data?{data:{items:e.data.items.map(e=>({...e,created_at:O(e.created_at||(new Date).toISOString())})),totalCount:e.data.totalCount,notices:e.data.notices}}:{data:{items:[],totalCount:0,notices:[]}}}),Lt=e=>$({queryKey:["boards"],queryFn:()=>Xe.getBoards(),staleTime:36e5,gcTime:864e5,retry:3,enabled:e?.enabled,select:e=>"N"!==e.successOrNot&&e.data?e:{...e,data:[]}}),Rt=(e,t)=>$({queryKey:["comments",e],queryFn:()=>L.getComments(e),staleTime:3e5,gcTime:18e5,retry:2,enabled:t?.enabled??!0,select:e=>{if("N"===e.successOrNot)return{data:{items:[],totalCount:0}};if(!e.data)return{data:{items:[],totalCount:0}};return{data:{items:Array.isArray(e.data.items)?e.data.items.map(e=>({...e,created_at:O(e.created_at)})):[],totalCount:e.data.totalCount||0}}}}),Dt="1.3.0",Ft="@team-semicolon/community-core";const Bt=function(){const e=R(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"sb-access-token",storage:{getItem:e=>{if("undefined"==typeof window)return null;try{const t=document.cookie.split("; ").find(t=>t.startsWith(`${e}=`))?.split("=")[1];if(!t)return null;const r=decodeURIComponent(t);try{const t=JSON.parse(r);t?.access_token&&Promise.resolve().then(function(){return Se}).then(({decodeJWTPayload:r,isTokenExpired:n,removeExpiredTokenFromCookie:s})=>{const a=r(t.access_token);a&&n(a)&&(console.log("ğŸ—‘ï¸ í´ë¼ì´ì–¸íŠ¸ Storage: ë§Œë£Œëœ í† í° ê°ì§€, ì •ë¦¬ ì¤‘..."),s(e))})}catch(e){console.warn("í´ë¼ì´ì–¸íŠ¸ Storage: ì„¸ì…˜ ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:",e)}return r}catch(e){return console.error("âŒ í´ë¼ì´ì–¸íŠ¸: ì¿ í‚¤ ì½ê¸° ì‹¤íŒ¨:",e),null}},setItem:(e,t)=>{if("undefined"!=typeof window)try{if(!JSON.parse(t).access_token)return;const r=encodeURIComponent(t),n=new Date;n.setDate(n.getDate()+30),document.cookie=`${e}=${r}; expires=${n.toUTCString()}; path=/; SameSite=Lax; Secure`}catch(e){}},removeItem:e=>{if("undefined"!=typeof window)try{document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`}catch(e){}}}}});if("undefined"!=typeof window){let t=!1;e.auth.onAuthStateChange((r,n)=>{switch(r){case"SIGNED_OUT":t||(t=!0,e.auth.getSession().then(()=>{t=!1}));break;case"TOKEN_REFRESHED":break;case"USER_UPDATED":n||t||(t=!0,e.auth.signOut().then(()=>{t=!1}))}})}return e}();var jt=Object.freeze({__proto__:null,clientSupabase:Bt});export{et as AuthService,Ue as Avatar,Pe as Badge,He as BaseService,Xe as BoardService,Ie as Button,Ae as Checkbox,Me as Input,Ft as PACKAGE_NAME,rt as PermissionService,Ye as PostService,$e as Radio,Ce as Select,Re as Skeleton,Fe as SkeletonAvatar,Be as SkeletonButton,je as SkeletonCard,De as SkeletonText,Oe as Switch,Le as TextArea,Je as UserService,Ee as Utils,Dt as VERSION,tt as authService,Ge as baseService,Ze as boardService,B as formatDate,D as formatNumberWithComma,_e as getPackageConfig,Te as initializeCommunityCore,G as isAdmin,nt as permissionService,Qe as postService,j as timeAgo,Pt as useAuth,Ut as useAuthGuard,Lt as useBoardQuery,Rt as useCommentQuery,Nt as useDeviceType,Ot as useDraftPostQuery,Et as useGlobalLoader,kt as usePermission,$t as usePostBookmarkQuery,At as usePostQuery,Tt as useRouterWithLoader,Ct as useUserPointHistoryQuery,Mt as useUserPointQuery,Ke as userService};
//# sourceMappingURL=index.esm.js.map
